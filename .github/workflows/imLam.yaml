name: Nodes

# è§¦å‘æ¡ä»¶
on:
 workflow_dispatch:

# schedule:
#  - cron: '0 */6 * * *'

jobs:
 my-job:
  name: imLam Job
  runs-on: ubuntu-latest
  steps:
  - uses: actions/checkout@v4
  - uses: actions/setup-python@v5 # Pythonç¯å¢ƒ
   with:
    python-version: '3.x' # Python 3.x
    cache: 'pip' # pip cache
     
  - name: install python packages
   run: |
    python -m pip install --upgrade pip
    pip install -r requirements.txt
     
  - name: Timezone # UTC+0 â†’ UTC+8
   run: sudo timedatectl set-timezone 'Asia/Shanghai'
    
  - name: é…ç½® Git
   run: | # é…ç½® Git çš„ä¸Šä¼ ç”¨æˆ·åå’Œé‚®ç®±
    git config pull.rebase false
    git config --local user.name "GitHub Actions"
    git config --local user.email "actions@github.com"
     
  - name: æ›´æ–° Xray
   run: | # æ›´æ–° Xray å¹¶æ£€æŸ¥è¿æ¥
    curl -sL ${{ secrets.CHECK_PROXIES }} | bash || exit 1
     
  - name: Base64
   run: | # å°†imLam.txtå†…å®¹è½¬Base64
    python ./main.py
     
  - name: æäº¤æ›´æ”¹
   run: | # æäº¤æ›´æ–°çš„è®¢é˜…æ–‡ä»¶
    git add ./imLam.txt
    git commit -m "ğŸŸ¢$(date '+%Y-%m-%d %H:%M:%S')"
    git push origin main
